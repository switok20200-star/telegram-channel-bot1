from telegram import Update
from telegram.ext import ApplicationBuilder, MessageHandler, filters, ContextTypes
import os

# === НАСТРОЙКИ ===
# Токен и канал укажешь на Render через Environment Variables (переменные окружения)
TOKEN = os.getenv("BOT_TOKEN")
CHANNEL_ID = os.getenv("CHANNEL_ID")

# === ОБРАБОТКА СООБЩЕНИЙ ===
async def forward_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = update.message.from_user
    text = update.message.text
    message_text = f"✉️ Сообщение от @{user.username or user.first_name}:\n{text}"
    await context.bot.send_message(chat_id=CHANNEL_ID, text=message_text)

# === ЗАПУСК БОТА ===
app = ApplicationBuilder().token(TOKEN).build()
app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, forward_message))

print("✅ Бот запущен и ждёт сообщения...")
app.run_polling()
